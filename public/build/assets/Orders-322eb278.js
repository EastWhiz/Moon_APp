import{C as Re,r as a,j as e,a as Oe}from"./app-68bbfc34.js";import{A as qe}from"./ClientLayout-ea0f890a.js";import"./sweetalert2.all-1dae64e9.js";import{u as Ie,a as Fe,I as u,B as T,b as m,S as Ne,c as Be,P as $e}from"./Select-b067bdae.js";import{M as V,B as W,F as z}from"./Modal-68b98716.js";import{B as h,T as g}from"./Box-59f27379.js";import{T as De,a as Me,b as Le,c as H,d as x,e as Qe}from"./TableRow-1cdc1566.js";import"./ResponsiveNavLink-4290db3c.js";import"./transition-c4fee4e3.js";import"./TransitionGroup-56084718.js";import"./CSSTransition-90f764bf.js";import"./useSlot-ae76aec5.js";import"./useTheme-145356ef.js";function at({auth:Ue}){const k=Re().props,{query:J}=k.ziggy;console.log(k);function G(t){return Object.keys(t).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(t[s])}`).join("&")}const K=G(J),[X,Y]=a.useState(""),[o,Z]=a.useState(!1),[P,ee]=a.useState(!1),[A,R]=a.useState(!1),te=t=>{const s=t.items.map((d,l)=>({item:d.name,quantity:d.quantity,price:d.price}));Z({id:t.order_name,customerName:t.customer_name,address:t.customer_address,address_two:t.customer_address_two,total:t.final_total,items:s,financialStatus:t.payment_status,fulfillmentStatus:t.fulfillment_status?t.fulfillment_status:"N/A"}),R(!0)},O=()=>R(!1),[q,I]=a.useState(!1),F=(t,s)=>{ee(s),Y(t),I(!0)},N=()=>I(!1),se={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:"90%",sm:"70%",md:"60%",lg:"50%",xl:"50%"},bgcolor:"background.paper",boxShadow:24,p:3,pt:2,height:"420px",overflow:"auto"},ae={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:"90%",sm:"70%",md:"35%",lg:"32%",xl:"32%"},bgcolor:"background.paper",boxShadow:24,p:3,pt:3,overflow:"auto"};let B=null;const le={singular:"order",plural:"orders"},[i,ne]=a.useState([]),re=[{label:"5",value:"5"},{label:"10",value:"10"},{label:"20",value:"20"},{label:"50",value:"50"},{label:"100",value:"100"}],[y,oe]=a.useState("10"),ie=a.useCallback(t=>{oe(t),c(!r)},[i]),[f,ce]=a.useState(0),de=["All"].map((t,s)=>({content:t,index:s,onAction:()=>{},id:`${t}-${s}`,isLocked:s===0,actions:[]})),ue=[{label:"Id",value:"id asc",directionLabel:"Ascending"},{label:"Id",value:"id desc",directionLabel:"Descending"}],[j,pe]=a.useState(["id desc"]),{mode:he,setMode:xe}=Ie(),me=()=>{},[C,$]=a.useState(""),[D,ge]=a.useState([]),[M,fe]=a.useState(""),[n,S]=a.useState({path:route("orders.get.client"),next_cursor:null,next_page_url:null,prev_cursor:null,prev_page_url:null}),[L,p]=a.useState(null),[je,_]=a.useState(!1),[r,c]=a.useState(!1),{selectedResources:Q,allResourcesSelected:be,handleSelectionChange:ye}=Fe(i);a.useEffect(()=>{let t=new URL(n.path);y&&t.searchParams.set("page_count",y),L&&t.searchParams.set("cursor",L),f==0?t.searchParams.delete("status"):f==1?t.searchParams.set("status","approved"):f==2&&t.searchParams.set("status","unapproved"),C!=""?t.searchParams.set("q",C):t.searchParams.delete("q"),j!=""?t.searchParams.set("q5",j[0]):t.searchParams.delete("q5"),D.length!=0?t.searchParams.set("q2",JSON.stringify(D)):t.searchParams.delete("q2"),M.length!=0?t.searchParams.set("q3",JSON.stringify(M)):t.searchParams.delete("q3"),t=t.toString()+"&"+K,_(!0),fetch(t).then(s=>s.json()).then(s=>{if(s.success==!0){const d=s.data.data.map((l,Te)=>({id:l.id,store_name:l.shop.store_name?l.shop.store_name:l.shop.name,order_date:new Date(l.order_created_at).toISOString().split("T")[0],order_no:l.order_name,customer_name:l.customer_name,customer_email:l.email,order_total:`$${l.final_total}`,greeting_card:l.cards.length>0?l.cards[0]:!1,message:l.messages?l.messages.message:!1,order:l}));ne(d),S({path:s.data.path,next_cursor:s.data.next_cursor,next_page_url:s.data.next_page_url,prev_cursor:s.data.prev_cursor,prev_page_url:s.data.prev_page_url})}_(!1)}).catch(s=>{_(!1)})},[r]),a.useEffect(()=>{c(!r)},[j]);const Ce=a.useCallback(t=>{$(t),clearTimeout(B),B=setTimeout(()=>{p(null),c(!r)},500)},[i]),v=a.useCallback(()=>{$(""),p(null),c(!r)},[i]),U=a.useCallback(()=>{ge([]),p(null),c(!r)},[i]),E=a.useCallback(()=>{fe([]),p(null),c(!r)},[i]),Se=a.useCallback(()=>{v(),U(),E()},[v,U,E]),_e=[],ve=[],we=i.map(({id:t,store_name:s,order_date:d,order_no:l,customer_name:Te,customer_email:Ee,order_total:ke,greeting_card:b,order:Pe,message:w},Ae)=>e.jsxs(u.Row,{id:t,selected:Q.includes(t),position:Ae,children:[e.jsx(u.Cell,{children:l}),e.jsx(u.Cell,{children:d}),e.jsx(u.Cell,{children:ke}),e.jsx(u.Cell,{children:b?e.jsx(T,{status:"success",children:"Card"}):w?e.jsx(T,{status:"attention",children:"Message"}):e.jsx(T,{status:"warning",children:"None"})}),e.jsxs(u.Cell,{children:[b?e.jsx(m,{onClick:()=>F(`${window.appURL}/${b.canvas_image}`,"CARD"),children:"Card"}):w?e.jsx(m,{onClick:()=>F(`${window.appURL}/${b.canvas_image}`,w),children:"Message"}):null,e.jsx("span",{style:{marginLeft:"10px"}}),e.jsx(m,{onClick:()=>te(Pe),children:"Details"})]})]},t));return e.jsxs(qe,{header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:" Dashboard "}),children:[e.jsx(Oe,{title:"Orders"}),e.jsx("div",{children:e.jsx(V,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",open:A,onClose:O,closeAfterTransition:!0,slots:{backdrop:W},slotProps:{backdrop:{timeout:100}},children:e.jsx(z,{in:A,children:e.jsx(h,{sx:se,children:o&&e.jsxs("div",{style:{backgroundColor:"white",margin:"auto",display:"flex",flexDirection:"column",height:"100%"},children:[e.jsxs(g,{variant:"h5",gutterBottom:!0,align:"left",children:["Order ",o.id]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"20px"},children:[e.jsxs(g,{variant:"body1",style:{textAlign:"left",maxWidth:"350px"},children:["Billing Address: ",o.address,e.jsx("br",{}),"Shipping Address: ",o.address_two]}),e.jsxs(g,{variant:"body1",style:{textAlign:"right"},children:["Financial Status: ",o.financialStatus,e.jsx("br",{}),"Fulfillment Status: ",o.fulfillmentStatus]})]}),e.jsx(De,{children:e.jsxs(Me,{children:[e.jsx(Le,{children:e.jsxs(H,{children:[e.jsx(x,{align:"left",style:{fontWeight:"bold"},children:"Item"}),e.jsx(x,{align:"center",style:{fontWeight:"bold"},children:"Quantity"}),e.jsx(x,{align:"right",style:{fontWeight:"bold"},children:"Price"})]})}),e.jsx(Qe,{children:o.items.map((t,s)=>e.jsxs(H,{children:[e.jsx(x,{align:"left",children:t.item}),e.jsx(x,{align:"center",children:t.quantity}),e.jsxs(x,{align:"right",children:["$",t.price*t.quantity]})]},s))})]})}),e.jsx("div",{style:{flex:"1"}}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"15px"},children:e.jsxs(g,{variant:"h6",children:["Total: $",o.total]})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"10px"},children:e.jsx(m,{variant:"contained",color:"primary",onClick:O,children:"Close"})})]})})})})}),e.jsx("div",{children:e.jsx(V,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",open:q,onClose:N,closeAfterTransition:!0,slots:{backdrop:W},slotProps:{backdrop:{timeout:100}},children:e.jsx(z,{in:q,children:e.jsx(h,{sx:ae,children:e.jsxs("div",{style:{backgroundColor:"white",margin:"auto",display:"flex",flexDirection:"column",height:"100%"},children:[P=="CARD"?e.jsx("img",{src:X,style:{objectFit:"cover",height:"340px"}}):e.jsx("p",{children:P}),e.jsx("div",{style:{flex:"1"}}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"10px"},children:e.jsx(m,{variant:"contained",color:"primary",onClick:N,children:"Close"})})]})})})})}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm",children:e.jsxs(h,{p:2,children:[e.jsx(h,{children:e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",m:1,mb:2},children:[e.jsx(g,{variant:"h5",component:"div",sx:{fontSize:{xs:"20px",sm:"20px",md:"20px",lg:"22px",xl:"22px"}},children:"Orders"}),e.jsx(Ne,{labelInline:!0,label:"Rows:",options:re,value:y,onChange:ie})]})}),e.jsxs(h,{children:[e.jsx(Be,{sortOptions:ue,sortSelected:j,queryValue:C,queryPlaceholder:"Searching in all",onQueryChange:Ce,onQueryClear:v,onSort:pe,cancelAction:{onAction:me,disabled:!1,loading:!1},tabs:de,selected:f,onSelect:ce,canCreateNewView:!1,filters:_e,appliedFilters:ve,onClearAll:Se,mode:he,setMode:xe,loading:je}),e.jsx(u,{resourceName:le,itemCount:i.length,selectedItemsCount:be?"All":Q.length,onSelectionChange:ye,headings:[{title:"Order #"},{title:"Date"},{title:"Order Total"},{title:"Moonora"},{title:"Action"}],hasMoreItems:!0,selectable:!1,children:we})]}),e.jsx("hr",{}),e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",paddingTop:"22px",paddingBottom:"5px"},children:e.jsx($e,{hasNext:!!n.next_cursor,hasPrevious:!!n.prev_cursor,onNext:()=>{S({...n,path:n.next_page_url}),p(n.next_cursor),c(!r)},onPrevious:()=>{S({...n,path:n.prev_page_url}),p(n.prev_cursor),c(!r)}})})]})})})})]})}export{at as default};
