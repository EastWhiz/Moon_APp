import{r as a,j as e,a as X}from"./app-9ead5a7f.js";import{A as Z}from"./AuthenticatedLayout-ea0be1d0.js";import{T as w}from"./ToggleSmall-dff8100e.js";import{S as P}from"./sweetalert2.all-47711847.js";import{u as ee,a as te,I as u,B,S as se,c as ae,P as le}from"./Select-739d4dca.js";import{B as m,T as ne}from"./Box-b88cc9cd.js";import"./ApplicationLogo-16b87ce4.js";import"./ResponsiveNavLink-b95b039c.js";import"./transition-8b02ee04.js";import"./TransitionGroup-233893ca.js";import"./CSSTransition-ea829b92.js";function be({auth:T}){const A=P.mixin({customClass:{confirmButton:"main_button",cancelButton:"main_dim_button"},buttonsStyling:!1});let _=null;const I={singular:"shop",plural:"shops "},[i,N]=a.useState([]),R=[{label:"5",value:"5"},{label:"10",value:"10"},{label:"20",value:"20"},{label:"50",value:"50"},{label:"100",value:"100"}],[g,k]=a.useState("10"),E=a.useCallback(t=>{k(t),c(!n)},[i]),[q,D]=a.useState(0),F=["All"].map((t,s)=>({content:t,index:s,onAction:()=>{},id:`${t}-${s}`,isLocked:s===0,actions:[]})),L=[{label:"Id",value:"id asc",directionLabel:"Ascending"},{label:"Id",value:"id desc",directionLabel:"Descending"}],[d,M]=a.useState(["id asc"]),{mode:O,setMode:Q}=ee(),V=()=>{},[f,j]=a.useState(""),[l,b]=a.useState({path:route("shops.get"),next_cursor:null,next_page_url:null,prev_cursor:null,prev_page_url:null}),[v,p]=a.useState(null),[J,S]=a.useState(!1),[n,c]=a.useState(!1),{selectedResources:y,allResourcesSelected:$,handleSelectionChange:z}=te(i);a.useEffect(()=>{let t=new URL(l.path);g&&t.searchParams.set("page_count",g),v&&t.searchParams.set("cursor",v),f!=""?t.searchParams.set("q",f):t.searchParams.delete("q"),d!=""?t.searchParams.set("q5",d[0]):t.searchParams.delete("q5"),t=t.toString(),S(!0),fetch(t).then(s=>s.json()).then(s=>{if(s.success==!0){const r=s.data.data.map((o,h)=>({id:o.id,name:o.store_name?o.store_name:o.name,status:o.status}));N(r),b({path:s.data.path,next_cursor:s.data.next_cursor,next_page_url:s.data.next_page_url,prev_cursor:s.data.prev_cursor,prev_page_url:s.data.prev_page_url})}S(!1)}).catch(s=>{S(!1)})},[n]),a.useEffect(()=>{c(!n)},[d]);const H=a.useCallback(t=>{j(t),clearTimeout(_),_=setTimeout(()=>{p(null),c(!n)},500)},[i]),C=a.useCallback(()=>{j(""),p(null),c(!n)},[i]),U=a.useCallback(()=>{C()},[C]),W=[],Y=[],G=i.map(({id:t,name:s,status:r},o)=>e.jsxs(u.Row,{id:t,selected:y.includes(t),position:o,children:[e.jsx(u.Cell,{children:t}),e.jsx(u.Cell,{children:s}),e.jsx(u.Cell,{children:r?e.jsx(B,{status:"success",children:"Enabled"}):e.jsx(B,{status:"critical",children:"Disabled"})}),e.jsx(u.Cell,{children:r?e.jsx(w,{toggled:r,disabled:!0}):e.jsx(w,{toggled:!!r,onClick:h=>{h.target.checked&&A.fire({title:"Are you sure?",text:"Moonora will be enabled for this store!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, Enable!",cancelButtonText:"No, Cancel!",reverseButtons:!0}).then(x=>{x.isConfirmed&&K(!0,t)})}})})]},t)),K=(t,s)=>{async function r(h){try{(await(await fetch("/admin/enable-shop",{method:"POST",body:JSON.stringify(h),headers:{"Content-Type":"application/json"}})).json()).success&&(c(!n),P.fire("Success!","Shop is Enabled.","success"))}catch(x){console.error("Error:",x)}}r({user_id:s,enable:t})};return e.jsxs(Z,{user:T.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:" Dashboard "}),children:[e.jsx(X,{title:"Shops"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm",children:e.jsxs(m,{p:2,children:[e.jsx(m,{children:e.jsxs(m,{sx:{display:"flex",justifyContent:"space-between",m:1,mb:2},children:[e.jsx(ne,{variant:"h5",component:"div",sx:{fontSize:{xs:"20px",sm:"20px",md:"20px",lg:"22px",xl:"22px"}},children:"Shops"}),e.jsx(se,{labelInline:!0,label:"Rows:",options:R,value:g,onChange:E})]})}),e.jsxs(m,{children:[e.jsx(ae,{sortOptions:L,sortSelected:d,queryValue:f,queryPlaceholder:"Searching in all",onQueryChange:H,onQueryClear:C,onSort:M,cancelAction:{onAction:V,disabled:!1,loading:!1},tabs:F,selected:q,onSelect:D,canCreateNewView:!1,filters:W,appliedFilters:Y,onClearAll:U,mode:O,setMode:Q,loading:J}),e.jsx(u,{resourceName:I,itemCount:i.length,selectedItemsCount:$?"All":y.length,onSelectionChange:z,headings:[{title:"ID"},{title:"Shop Name"},{title:"Status"},{title:"Action"}],hasMoreItems:!0,selectable:!1,children:G})]}),e.jsx("hr",{}),e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",paddingTop:"22px",paddingBottom:"5px"},children:e.jsx(le,{hasNext:!!l.next_cursor,hasPrevious:!!l.prev_cursor,onNext:()=>{b({...l,path:l.next_page_url}),p(l.next_cursor),c(!n)},onPrevious:()=>{b({...l,path:l.prev_page_url}),p(l.prev_cursor),c(!n)}})})]})})})})]})}export{be as default};
