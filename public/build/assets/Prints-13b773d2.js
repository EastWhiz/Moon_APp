import{r as l,R as I,C as we,j as e,a as Pe}from"./app-7ccfca03.js";import{A as Te}from"./ClientLayout-f5be7ba3.js";import{S as q}from"./sweetalert2.all-ceb92559.js";import{d as _e,U as Ae,u as Ne,a as Re,I as a,B as S,b as k,S as Fe,c as Ie,P as qe}from"./Select-b8e5c06c.js";import{B as d,T as g}from"./Box-64f33cf3.js";import{M as G,B as K,F as X}from"./Modal-36c61420.js";import{T as Be,a as Ee,b as Oe,c as Y,d as u,e as Le}from"./TableRow-43378f48.js";import"./ResponsiveNavLink-543de141.js";import"./transition-a93525fd.js";import"./TransitionGroup-af67ebd4.js";import"./CSSTransition-b29a8b6a.js";import"./useSlot-5984c1dc.js";import"./useTheme-c5a76e37.js";const De=l.createContext(!1);var B={Link:"Polaris-Link",monochrome:"Polaris-Link--monochrome",removeUnderline:"Polaris-Link--removeUnderline"};function Ve({url:v,children:p,onClick:x,external:w,target:P,id:f,monochrome:E,removeUnderline:n,accessibilityLabel:T,dataPrimaryLink:m}){return I.createElement(De.Consumer,null,O=>{const j=E||O,b=_e(B.Link,j&&B.monochrome,n&&B.removeUnderline);return v?I.createElement(Ae,{onClick:x,className:b,url:v,external:w,target:P,id:f,"aria-label":T,"data-primary-link":m},p):I.createElement("button",{type:"button",onClick:x,className:b,id:f,"aria-label":T,"data-primary-link":m},p)})}function et({auth:v}){const p=we().props,{query:x}=p.ziggy;console.log(p);function w(t){return Object.keys(t).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(t[s])}`).join("&")}const P=w(x),[f,E]=l.useState(""),[n,T]=l.useState(!1),[m,O]=l.useState(!1),[j,b]=l.useState(!1),L=()=>b(!1),[D,Z]=l.useState(!1),V=()=>Z(!1),ee={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:"90%",sm:"70%",md:"60%",lg:"50%",xl:"50%"},bgcolor:"background.paper",boxShadow:24,p:3,pt:2,height:"420px",overflow:"auto"},te={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:"90%",sm:"70%",md:"35%",lg:"32%",xl:"32%"},bgcolor:"background.paper",boxShadow:24,p:3,pt:3,overflow:"auto"};let U=null;const se={singular:"print",plural:"prints"},[c,le]=l.useState([]),ae=[{label:"5",value:"5"},{label:"10",value:"10"},{label:"20",value:"20"},{label:"50",value:"50"},{label:"100",value:"100"}],[_,re]=l.useState("10"),ne=l.useCallback(t=>{re(t),i(!r)},[c]),[y,ie]=l.useState(0),oe=["All"].map((t,s)=>({content:t,index:s,onAction:()=>{},id:`${t}-${s}`,isLocked:s===0,actions:[]})),ce=[{label:"Id",value:"id asc",directionLabel:"Ascending"},{label:"Id",value:"id desc",directionLabel:"Descending"}],[C,de]=l.useState(["id desc"]),{mode:he,setMode:ue}=Ne(),pe=()=>{},[A,M]=l.useState(""),[Q,xe]=l.useState([]),[$,me]=l.useState(""),[o,N]=l.useState({path:route("prints.get.client"),next_cursor:null,next_page_url:null,prev_cursor:null,prev_page_url:null}),[W,h]=l.useState(null),[ge,R]=l.useState(!1),[r,i]=l.useState(!1),{selectedResources:z,allResourcesSelected:fe,handleSelectionChange:je}=Re(c);l.useEffect(()=>{let t=new URL(o.path);_&&t.searchParams.set("page_count",_),W&&t.searchParams.set("cursor",W),y==0?t.searchParams.delete("status"):y==1?t.searchParams.set("status","approved"):y==2&&t.searchParams.set("status","unapproved"),A!=""?t.searchParams.set("q",A):t.searchParams.delete("q"),C!=""?t.searchParams.set("q5",C[0]):t.searchParams.delete("q5"),Q.length!=0?t.searchParams.set("q2",JSON.stringify(Q)):t.searchParams.delete("q2"),$.length!=0?t.searchParams.set("q3",JSON.stringify($)):t.searchParams.delete("q3"),t=t.toString()+"&"+P,R(!0),fetch(t).then(s=>s.json()).then(s=>{s.success==!0&&(le(s.data.data),N({path:s.data.path,next_cursor:s.data.next_cursor,next_page_url:s.data.next_page_url,prev_cursor:s.data.prev_cursor,prev_page_url:s.data.prev_page_url})),R(!1)}).catch(s=>{R(!1)})},[r]),l.useEffect(()=>{i(!r)},[C]),l.useEffect(()=>{const t=setInterval(()=>{console.log("checkingNewChanges"),i(!r)},6e4);return()=>clearInterval(t)},[]);const be=l.useCallback(t=>{M(t),clearTimeout(U),U=setTimeout(()=>{h(null),i(!r)},500)},[c]),F=l.useCallback(()=>{M(""),h(null),i(!r)},[c]),H=l.useCallback(()=>{xe([]),h(null),i(!r)},[c]),J=l.useCallback(()=>{me([]),h(null),i(!r)},[c]),ye=l.useCallback(()=>{F(),H(),J()},[F,H,J]),Ce=t=>{fetch(route("retry.print",x),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({order_print_id:t.id})}).then(s=>{if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);return s.json()}).then(s=>{s.success?(q.fire("Success",s.message,"success"),i(!r)):q.fire("Error",s.message,"error")}).catch(s=>{q.fire("Error",s.toString(),"error")})},Se=[],ke=[],ve=c.map((t,s)=>e.jsxs(a.Row,{id:t.id,selected:z.includes(t.id),position:s,children:[e.jsx(a.Cell,{children:e.jsx("div",{className:"custom_style",children:e.jsx(Ve,{dataPrimaryLink:!0,children:e.jsx("b",{children:t.order.order_name})})})}),e.jsx(a.Cell,{children:t.selectedDate}),e.jsx(a.Cell,{children:t.design}),e.jsx(a.Cell,{children:e.jsx(S,{status:t.cityVisible=="true"?"success":"critical",children:t.cityVisible})}),e.jsx(a.Cell,{children:e.jsx(S,{status:t.dateVisible=="true"?"success":"critical",children:t.dateVisible})}),e.jsx(a.Cell,{children:e.jsx(S,{status:t.starsEffect=="true"?"success":"critical",children:t.starsEffect})}),e.jsx(a.Cell,{children:t.title??"N/A"}),e.jsx(a.Cell,{children:t.titleFont??"N/A"}),e.jsx(a.Cell,{children:t.paragraphText??"N/A"}),e.jsx(a.Cell,{children:t.paragraphTextFont??"N/A"}),e.jsx(a.Cell,{children:e.jsx(S,{status:t.status=="processed"?"success":"critical",children:t.status})}),e.jsxs(a.Cell,{children:[e.jsx(k,{disabled:!t.link,size:"slim",onClick:()=>window.open(t.link,"_blank"),children:"Open"}),e.jsx(d,{component:"span",ml:1}),e.jsx(k,{loading:t.status=="unprocessed",size:"slim",onClick:()=>Ce(t),children:"Re-Work"})]})]},t.id));return e.jsxs(Te,{header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:" Dashboard "}),children:[e.jsx(Pe,{title:"Prints"}),e.jsx("div",{children:e.jsx(G,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",open:j,onClose:L,closeAfterTransition:!0,slots:{backdrop:K},slotProps:{backdrop:{timeout:100}},children:e.jsx(X,{in:j,children:e.jsx(d,{sx:ee,children:n&&e.jsxs("div",{style:{backgroundColor:"white",margin:"auto",display:"flex",flexDirection:"column",height:"100%"},children:[e.jsxs(g,{variant:"h5",gutterBottom:!0,align:"left",children:["Print ",n.id]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"20px"},children:[e.jsxs(g,{variant:"body1",style:{textAlign:"left",maxWidth:"350px"},children:["Billing Address: ",n.address,e.jsx("br",{}),"Shipping Address: ",n.address_two]}),e.jsxs(g,{variant:"body1",style:{textAlign:"right"},children:["Financial Status: ",n.financialStatus,e.jsx("br",{}),"Fulfillment Status: ",n.fulfillmentStatus]})]}),e.jsx(Be,{children:e.jsxs(Ee,{children:[e.jsx(Oe,{children:e.jsxs(Y,{children:[e.jsx(u,{align:"left",style:{fontWeight:"bold"},children:"Item"}),e.jsx(u,{align:"center",style:{fontWeight:"bold"},children:"Quantity"}),e.jsx(u,{align:"right",style:{fontWeight:"bold"},children:"Price"})]})}),e.jsx(Le,{children:n.items.map((t,s)=>e.jsxs(Y,{children:[e.jsx(u,{align:"left",children:t.item}),e.jsx(u,{align:"center",children:t.quantity}),e.jsxs(u,{align:"right",children:["$",t.price*t.quantity]})]},s))})]})}),e.jsx("div",{style:{flex:"1"}}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"15px"},children:e.jsxs(g,{variant:"h6",children:["Total: $",n.total]})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"10px"},children:e.jsx(k,{variant:"contained",color:"primary",onClick:L,children:"Close"})})]})})})})}),e.jsx("div",{children:e.jsx(G,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",open:D,onClose:V,closeAfterTransition:!0,slots:{backdrop:K},slotProps:{backdrop:{timeout:100}},children:e.jsx(X,{in:D,children:e.jsx(d,{sx:te,children:e.jsxs("div",{style:{backgroundColor:"white",margin:"auto",display:"flex",flexDirection:"column",height:"100%"},children:[m=="CARD"?e.jsx("img",{src:f,style:{objectFit:"cover",height:"340px"}}):e.jsx("p",{children:m}),e.jsx("div",{style:{flex:"1"}}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"10px"},children:e.jsx(k,{variant:"contained",color:"primary",onClick:V,children:"Close"})})]})})})})}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm",children:e.jsxs(d,{p:2,children:[e.jsx(d,{children:e.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",m:1,mb:2},children:[e.jsx(g,{variant:"h5",component:"div",sx:{fontSize:{xs:"20px",sm:"20px",md:"20px",lg:"22px",xl:"22px"}},children:"Prints"}),e.jsx(Fe,{labelInline:!0,label:"Rows:",options:ae,value:_,onChange:ne})]})}),e.jsxs(d,{children:[e.jsx(Ie,{sortOptions:ce,sortSelected:C,queryValue:A,queryPlaceholder:"Searching in all",onQueryChange:be,onQueryClear:F,onSort:de,cancelAction:{onAction:pe,disabled:!1,loading:!1},tabs:oe,selected:y,onSelect:ie,canCreateNewView:!1,filters:Se,appliedFilters:ke,onClearAll:ye,mode:he,setMode:ue,loading:ge}),e.jsx(a,{resourceName:se,itemCount:c.length,selectedItemsCount:fe?"All":z.length,onSelectionChange:je,headings:[{title:"Order #"},{title:"Date"},{title:"Design"},{title:"City Visible"},{title:"Date Visible"},{title:"Stars Effect"},{title:"Title"},{title:"Title Font"},{title:"Paragraph"},{title:"Paragraph Font"},{title:"Status"},{title:"Actions"}],hasMoreItems:!0,selectable:!1,children:ve})]}),e.jsx("hr",{}),e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",paddingTop:"22px",paddingBottom:"5px"},children:e.jsx(qe,{hasNext:!!o.next_cursor,hasPrevious:!!o.prev_cursor,onNext:()=>{N({...o,path:o.next_page_url}),h(o.next_cursor),i(!r)},onPrevious:()=>{N({...o,path:o.prev_page_url}),h(o.prev_cursor),i(!r)}})})]})})})})]})}export{et as default};
